# Account-specific variables (populated dynamically)
variable "account_id" {
  description = "AWS Account ID being provisioned"
  type        = string
  default     = null  # Will be populated via data source
}

variable "account_region" {
  description = "Primary AWS region for the account"
  type        = string
  default     = "{{ provider_region }}"
}

# Multi-Region Configuration
variable "target_regions" {
  description = "List of AWS regions to apply Security Group quota increases"
  type        = list(string)
  default     = [
    "us-east-1",           # Required for global services
    "{{ provider_region }}", # Primary region from AFT
    "eu-west-2",           # Common European region
    "ap-southeast-1"       # Common Asian region
  ]
  
  validation {
    condition     = length(var.target_regions) > 0
    error_message = "At least one target region must be specified."
  }
}

variable "enable_quota_automation" {
  description = "Enable automatic Security Group quota requests"
  type        = bool
  default     = true
}

variable "regional_quota_settings" {
  description = "Per-region quota configuration settings"
  type = map(object({
    enabled       = bool
    target_value  = number
    priority      = string
  }))
  default = {
    "us-east-1" = {
      enabled       = true
      target_value  = 200
      priority      = "high"
    }
    "eu-west-2" = {
      enabled       = true
      target_value  = 200
      priority      = "high"
    }
    "us-west-2" = {
      enabled       = true
      target_value  = 200
      priority      = "medium"
    }
    "ap-southeast-1" = {
      enabled       = true
      target_value  = 200
      priority      = "medium"
    }
  }
}

# Quota configuration variables
variable "quota_service_code" {
  description = "AWS service code for VPC service quotas"
  type        = string
  default     = "vpc"
  
  validation {
    condition     = var.quota_service_code == "vpc"
    error_message = "Service code must be 'vpc' for Security Group quotas."
  }
}

variable "quota_code" {
  description = "Quota code for Security Group rules per security group"
  type        = string
  default     = "L-0EA8095F"
  
  validation {
    condition     = var.quota_code == "L-0EA8095F"
    error_message = "Quota code must be 'L-0EA8095F' for Security Group rules per SG."
  }
}

variable "default_current_quota_value" {
  description = "Current Security Group rules quota (AWS default)"
  type        = number
  default     = 60
}

variable "default_target_quota_value" {
  description = "Default target Security Group rules quota"
  type        = number
  default     = 200
  
  validation {
    condition     = var.default_target_quota_value > 60
    error_message = "Target quota must be greater than current default (60)."
  }
}

# Regional Processing Configuration
variable "enable_regional_validation" {
  description = "Enable validation checks for each target region"
  type        = bool
  default     = true
}

variable "quota_request_reason" {
  description = "Business justification for quota increase request"
  type        = string
  default     = "Multi-region automated quota increase for Security Group rules to support operational requirements. Increasing from default 60 to 200 rules per security group to accommodate application security requirements across multiple AWS regions."
}

variable "regional_deployment_strategy" {
  description = "Strategy for deploying quotas across regions"
  type        = string
  default     = "parallel"
  
  validation {
    condition     = contains(["parallel", "sequential"], var.regional_deployment_strategy)
    error_message = "Regional deployment strategy must be either 'parallel' or 'sequential'."
  }
}

# AFT Integration Variables
variable "aft_timestamp" {
  description = "AFT execution timestamp"
  type        = string
  default     = "{{ timestamp }}"
}

variable "aft_account_request_id" {
  description = "AFT account request identifier"
  type        = string
  default     = "{{ timestamp }}"
}

# Advanced Configuration
variable "enable_quota_monitoring" {
  description = "Enable quota usage monitoring and alerts"
  type        = bool
  default     = true
}

variable "quota_utilization_threshold" {
  description = "Threshold percentage for quota utilization alerts"
  type        = number
  default     = 80
  
  validation {
    condition     = var.quota_utilization_threshold > 0 && var.quota_utilization_threshold <= 100
    error_message = "Quota utilization threshold must be between 1 and 100."
  }
}