# variables.tf.jinja - AFT Global Customizations variables template
# This template defines variables for Security Group quota automation

# Account-specific variables (populated by AFT)
variable "account_id" {
  description = "AWS Account ID being provisioned"
  type        = string
  default     = "{{ account.id }}"
}

variable "account_name" {
  description = "AWS Account name"
  type        = string
  default     = "{{ account.name | default('Unknown') }}"
}

variable "account_region" {
  description = "Primary AWS region for the account"
  type        = string
  default     = "{{ account.region | default('eu-west-2') }}"
}

variable "account_environment" {
  description = "Environment designation for the account"
  type        = string
  default     = "{{ account.environment | default('production') }}"
}

# Quota configuration variables
variable "quota_service_code" {
  description = "AWS service code for VPC service quotas"
  type        = string
  default     = "{{ quota_config.service_code | default('vpc') }}"
  
  validation {
    condition     = var.quota_service_code == "vpc"
    error_message = "Service code must be 'vpc' for Security Group quotas."
  }
}

variable "quota_code" {
  description = "Quota code for Security Group rules per security group"
  type        = string
  default     = "{{ quota_config.quota_code | default('L-0EA8095F') }}"
  
  validation {
    condition     = var.quota_code == "L-0EA8095F"
    error_message = "Quota code must be 'L-0EA8095F' for Security Group rules per SG."
  }
}

variable "current_quota_value" {
  description = "Current Security Group rules quota (AWS default)"
  type        = number
  default     = {{ quota_config.current_default | default(60) }}
}

variable "target_quota_value" {
  description = "Target Security Group rules quota"
  type        = number
  default     = {{ quota_config.target_value | default(200) }}
  
  validation {
    condition     = var.target_quota_value > 60
    error_message = "Target quota must be greater than current default (60)."
  }
}

# AFT-specific variables
variable "aft_management_account_id" {
  description = "AFT Management Account ID"
  type        = string
  default     = "{{ aft.management_account_id | default('') }}"
}

variable "aft_request_id" {
  description = "AFT Request ID for tracking"
  type        = string
  default     = "{{ aft.request_id | default('') }}"
}

# Feature flags for conditional execution
variable "enable_quota_automation" {
  description = "Enable automatic Security Group quota requests"
  type        = bool
  default     = {{ quota_config.enabled | default(true) | lower }}
}

variable "quota_request_reason" {
  description = "Business justification for quota increase request"
  type        = string
  default     = "{{ quota_config.reason | default('Automated quota increase for Security Group rules to support operational requirements. Increasing from default 60 to 200 rules per security group to accommodate application security requirements.') }}"
}
